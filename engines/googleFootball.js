/*
	sp:2,tab:lb,emid:/g/11fk0cxp0k,rbpt:undefined,ct:VN,hl:en,tz:Asia/Saigon,dtoint:2020-01-17T19:30:00Z,dtointmid:/g/11fk0cxp0k,_id:liveresults-sports-immersive__league-fullpage,_pms:s,_jsfs:Ffpdje,_fmt:pc

	https://www.google.com/async/lr_lg_fp?async=
	emid:/g/11fj6snmjm,tz:Asia/Saigon,tab:st,_id:liveresults-sports-immersive__league-fullpage,_fmt:pc


	https://www.google.com/async/lr_lm_mt
	emid:/g/11fj6snmjm,moa:2019-12-01T14:00:00Z,_id:liveresults-sports-immersive__updatable-league-matches,_fmt:pc

	https://www.google.com/async/lr_sma_tb

	tab:mt --> match
	tab:st --> standing
	tab:nw --> news
	tab:lb --> stat (leader board)
	tab:pl --> player


	https://www.google.com/async/lr_sma_tb?vet=12ahUKEwjMoZmLp4LnAhWRWisKHcibAy0Qo-sBegQIARAW..i&ei=c0odXs2RKMG89QPBirTwBA&yv=3&q=&async=ct:VN,hl:en,tz:Asia%2FSaigon,dtoint:2020-01-17T19%3A30%3A00Z,dtointmid:%2Fg%2F11fk0cxp0k,emid:%2Fg%2F11fk0cxp0k,et:lg,gndr:MALE,lmid:%2Fm%2F037169,rtab:19,sp:2,_fmt:prog,_id:tab-1-19,_jsfs:Ffpdje


	cau thu: player
	https://www.google.com/async/lr_sma_tb?vet=12ahUKEwjMoZmLp4LnAhWRWisKHcibAy0Qo-sBegQIARAa..i&ei=c0odXs2RKMG89QPBirTwBA&yv=3&q=&async=ct:VN,hl:en,tz:Asia/Saigon,dtoint:2020-01-17T19:30:00Z,dtointmid:/g/11fk0cxp0k,emid:/g/11fk0cxp0k,et:lg,gndr:MALE,lmid:/m/037169,rtab:20,sp:2,_fmt:prog,_id:tab-1-20,_jsfs:Ffpdje

	standing - bang xep hang
	https://www.google.com/async/lr_sma_tb?vet=12ahUKEwjQvdeM0ILnAhWFfn0KHVc-CHQQo-sBegQIARAS..i&ei=b3UdXpP5G9u6rQHi06TYAQ&yv=3&q=&async=ct:VN,hl:vi,tz:Asia/Saigon,dtoint:2020-01-12T14:00:00Z,dtointmid:/g/11fj6snmjm,emid:/g/11fj6snmjm,et:lg,gndr:UNKNOWN_GENDER,lmid:/m/02_tc,rtab:3,sp:2,_fmt:prog,_id:tab-1-3,_jsfs:Ffpdje

	stat : thong so giai dau
	https://www.google.com/async/lr_sma_tb?vet=12ahUKEwjQvdeM0ILnAhWFfn0KHVc-CHQQo-sBegQIARAW..i&ei=b3UdXpP5G9u6rQHi06TYAQ&yv=3&q=&async=ct:VN,hl:vi,tz:Asia/Saigon,dtoint:2020-01-12T14:00:00Z,dtointmid:/g/11fj6snmjm,emid:/g/11fj6snmjm,et:lg,gndr:MALE,lmid:/m/02_tc,rtab:19,sp:2,_fmt:prog,_id:tab-1-19,_jsfs:Ffpdje

	cau thu : player
	https://www.google.com/async/lr_sma_tb?vet=12ahUKEwjQvdeM0ILnAhWFfn0KHVc-CHQQo-sBegQIARAa..i&ei=b3UdXpP5G9u6rQHi06TYAQ&yv=3&q=&async=ct:VN,hl:vi,tz:Asia/Saigon,dtoint:2020-01-12T14:00:00Z,dtointmid:/g/11fj6snmjm,emid:/g/11fj6snmjm,et:lg,gndr:MALE,lmid:/m/02_tc,rtab:20,sp:2,_fmt:prog,_id:tab-1-20,_jsfs:Ffpdje

	news - tin tuc
	https://www.google.com/search?vet=12ahUKEwjm05Sg0oLnAhUUbn0KHSF0BEUQo-sBegQIARA8..i&ei=s3cdXt_5EdT6rQGn96rgCg&yv=3&q=&asearch=lr_nt&async=emids:/m/02_tc,en:Ngoại hạng Anh,et:lg,lmid:/m/02_tc,mmid:,sp:2,_fmt:prog,_id:news-tab--347155782,_jsfs:Ffpdje

	-------------------
	1 CLB : Arsenal --> /m/0xbm

	https://www.google.com/async/lr_tm_fp?yv=3&q=t|/m/0xbm|mt|fp&async=sp:2,lmid:,tab:mt,emid:/m/0xbm,rbpt:undefined,ct:VN,hl:vi,tz:Asia/Saigon,dtoint:2020-01-12T14:00:00Z,dtointmid:/m/02_tc,_id:liveresults-sports-immersive__team-fullpage,_pms:s,_jsfs:Ffpdje,_fmt:pc
	---> trả full page những trận đấu của Arsenal

	search news của 1 CLB
	https://www.google.com/search?yv=3&q=&asearch=lr_nt&async=emids:/m/0xbm,en:Arsenal,et:tm,lmid:/m/02_tc,mmid:,sp:2,_fmt:prog,_id:news-tab-1928531459,_jsfs:Ffpdje

	tất cả cầu thủ của CLB
	https://www.google.com/async/lr_sma_tb?yv=3&q=&async=ct:VN,hl:vi,tz:Asia/Saigon,dtoint:2020-01-12T14:00:00Z,dtointmid:/m/02_tc,emid:/m/0xbm,et:tm,gndr:MALE,lmid:,rtab:20,sp:2,_fmt:prog,_id:tab-2-20,_jsfs:Ffpdje

	Các trận diễn ra trong thời gian của CLB
	https://www.google.com/async/lr_tm_mt?yv=3&async=sp:2,lmid:,emid:/m/0xbm,ftm:,stm:,et:t,emids:/g/11fls39rn6;/g/11hdstp7df;/g/11h3_zl351;/g/11hyk35nbf;/g/11fn2l02ry;/g/11fls36gnk;/g/11h_t58fqh;/g/11fls3h3gr;/g/11fn2l375n;/g/11fls39mf1;/g/11fls3804l;/g/11fn2l5gq6;/g/11fls36gnj;/g/11hyk3j6hb;/g/11hyk3fjsf;/g/11h_20hn_6;/g/11h3_zjhyt;/g/11hyk36p00;/g/11fls39rn4;/g/11fls383pl;/g/11h3_zjhyw;/g/11j3s1dt_m;/g/11hyk369j1;/g/11hyk369j4;/g/11fls3cz87;/g/11j1j0kwb7;/g/11fls3ff16;/g/11hyk3hpsr;/g/11hf3c_wj2;/g/11fls37gyj;/g/11j495r6wx;/g/11hyk3cfqm;/g/11fls3d_6d;/g/11fls35_gp;/g/11fls3ff13;/g/11h3_zdzrr;/g/11h3_zg4yz;/g/11fls39jk1;/g/11hyk3hsbr;/g/11hyk39qc2,moa:2020-05-02T14:00:00Z,_id:liveresults-sports-immersive__updatable-team-matches,_pms:s,_jsfs:Ffpdje,_fmt:pc
	---> co the bo emids

	search tên cầu thủ + "stats", query id="rso" hoac [data-attrid="kc:/sports/pro_athlete:stats"], xpath: //*[@id="tsuid33"]/span/div/div/div
	wiki: Xpath= //*[@id="rhs"]/div/div[1]/div[1]/div[1]/div

	Giờ hiển thị trên bảng là Indochina Time
*/
const moment = require('moment');
const cheerio = require('cheerio');
const request = require('request').defaults({
	headers: {
		'user-agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1',
		'sec-fetch-site': 'same-origin',
		'sec-fetch-mode': 'cors',
	},
  jar: true
})
const fs = require('fs');
const _ = require('lodash');

let cookie = request.jar();

const FOOTBALL_LEAGUE = require('./footballLeague');

const NEWS_ASYNC_EMIDS = {
	PREMIER_LEAGUE: 'emids:/m/02_tc,en:Ngoại hạng Anh,et:lg,lmid:/m/02_tc,mmid:,sp:2,_fmt:prog,_id:news-tab--347155782,_jsfs:Ffpdje',
}

const default_Option = {
	ct: 'VN',
	// hl: 'en',
	hl: 'vi',
	tz: 'Asia/Saigon',
	et: 'lg',
}

const safeParse = (str) => {
	if (typeof str === 'object') return str;
	try {
		return JSON.parse(str);
	} catch {
		return null;
	}
}

const _parseDataMatchOfLeague = (html) => {
	let $ = cheerio.load(html);

	let totalRound = -1;
	let roundStart = -1;
	let roundEnd = -1;

	let headings = $('[role="heading"]');
	let totalRoundText = $(headings[0]).text().trim().match(/\d{1,2}\/\d{1,2}/);

	if (totalRoundText && totalRoundText.length > 0) {
		totalRoundText = totalRoundText[0];
		roundStart = Number(totalRoundText.split('/')[0]);
		totalRound = Number(totalRoundText.split('/')[1]);
	}

	totalRoundText = $(headings[headings.length - 1]).text().trim().match(/\d{1,2}\/\d{1,2}/);

	if (totalRoundText && totalRoundText.length > 0) {
		totalRoundText = totalRoundText[0];
		roundEnd = Number(totalRoundText.split('/')[0]);
	}

	let GMT = '+7:00'; // default
	let utcOffset = 420;
	let timeDisplayText = $('.imso-ani > .imso-ani').text().trim().toLowerCase();

	if (timeDisplayText.indexOf('việt nam') > -1) {
		GMT = '+7:00';
		utcOffset = 420;
	}

	let listRound = [];
	let rounds = $('#liveresults-sports-immersive__updatable-league-matches > div');

	_.forEach(rounds, (round) => {
		let roundNumber = $('[role="heading"]', round).text().trim().match(/\d{1,2}\/\d{1,2}/);
		if (roundNumber && roundNumber.length > 0) {
			roundNumber = roundNumber[0];
			roundNumber = Number(roundNumber.split('/')[0]);
		}

		let matchs = [];
		let matchsInRound = $('[role="listitem"]', round);

		_.forEach(matchsInRound, (match) => {
			let rows = $('tr', match);

			let info = $('td', rows[2])[2]

			let isFullTimeText = $('.imspo_mt__match-status', info).text().trim().toUpperCase();
			isFullTime = isFullTimeText == 'KT' || isFullTimeText == 'FT' ? true : false;

			let host = rows[4];
			let client = rows[5];

			let host_tds = $('td', host);
			let client_tds = $('td', client);

			let host_club_lmid = $(host_tds[0]).attr('data-df-team-mid');
			let host_logo_src = $('td img', host).attr('src');
			let host_name = $('td span', host).text().trim();
			let host_score = Number($($('td div', host)[0]).text().trim());

			let client_club_lmid = $(client_tds[0]).attr('data-df-team-mid');
			let client_logo_src = $('td img', client).attr('src');
			let client_name = $('td span', client).text().trim();
			let client_score = Number($($('td div', client)[0]).text().trim());

			let winner = 'tie';

			if (host_score > client_score) winner = host_name;
			if (host_score < client_score) winner = client_name;

			let scoreText = `${host_score} - ${client_score}`;

			if (!isFullTime) {
				winner = null;
				host_score = null;
				client_score = null;
				scoreText = null;
			}

			let imsoLoa = $('.imso-loa', match);

			let matchMid = $(imsoLoa).attr('data-df-match-mid');
			let mid = $(imsoLoa).attr('data-mid');
			let date = $(imsoLoa).attr('data-start-time');

			let imsoHov = $('.imso-hov', match);
			let hveid = $(imsoHov).attr('data-hveid');
			let ved = $(imsoHov).attr('data-ved');

			let video = null;
			let a = $('a', info);

			if (a) {
				let label = $(a).attr('aria-label');
				let link = $(a).attr('href');
				let urlPing = 'https://www.google.com' + $(a).attr('ping'); // /url?sa=t&source=web&rct=j&url=https://www.youtube.com/watch%3Fv%3DXlU0Rwc4mXo%26feature%3Donebox&ved=2ahUKEwiCoL6T4YnnAhVHcCsKHdizC0wQs056BAgBEAY

				let thumbnail = $('img', a).attr('src'); // //ssl.gstatic.com/onebox/media/sports/videos/liga/-sRKeoDzDvXYayG9_192x108.jpg
				let durationText = $('span', a).text().trim(); // ► 1:31 --> convert to seccond

				video = {
					label,
					link,
					urlPing,
					thumbnail,
					durationText
				}
			}

			let objMatch = {
				host: {
					name: host_name,
					lmid: host_club_lmid,
					score: host_score,
					logoSrc: host_logo_src
				},

				client: {
					name: client_name,
					lmid: client_club_lmid,
					score: client_score,
					logoSrc: client_logo_src
				},

				scoreText,
				winner,
				isFullTime,
				matchMid,
				mid,
				hveid,
				ved,
				date,
			}

			if (video) objMatch['video'] = video;

			matchs.push(objMatch);
		})

		let objRound = {
			roundNumber,
			matchs
		}

		listRound.push(objRound);
	})

	let result = {
		roundStart,
		roundEnd,
		totalRound,
		listRound,
	}

	return result;
}

const matchOfLeague = (opt, callback) => {
	opt = Object.assign({}, default_Option, opt);

	let slug = opt.slug;

	if (!FOOTBALL_LEAGUE[slug]) return callback('ELEAGUENOTFOUND');

	let emid = FOOTBALL_LEAGUE[slug].emid;
	let lmid = FOOTBALL_LEAGUE[slug].lmid;

	let dtoint = moment().add(-3, 'd').utcOffset(0).format('YYYY-MM-DDTHH:00:00') + 'Z';

	// opt.date = opt.date || moment().utcOffset(0).format();

	let urlGet = `https://www.google.com/async/lr_sma_tb?async=ct:${opt.ct},hl:${opt.hl},tab:mt,tz:${opt.tz},dtoint:${dtoint},dtointmid:${emid},emid:${emid},et:lg,gndr:UNKNOWN_GENDER,lmid:${lmid},rtab:4,sp:2,_fmt:prog,_id:tab-1-4,_jsfs:Ffpdje`;

	if (opt.date) {
		urlGet = `https://www.google.com/async/lr_lm_mt?async=sp:2,ct:${opt.ct},hl:${opt.hl},tab:mt,tz:${opt.tz},emid:${emid},moa:${opt.date},_id:liveresults-sports-immersive__updatable-league-matches,_fmt:pc`;
	}

	console.log('matchOfLeague url=', urlGet);

	// moment.tz(moment('Sat, 1/18/2020 7:30 PM +07:00', 'ddd, MM/DD/YYYY hh:mm A Z'), "Asia/Saigon").format()

	request({
		url: urlGet,
		method: 'GET',
		jar: cookie
	}, (err, response, body) => {
		if (err) return callback(err);

		if (!body || body.length == 0) return callback();

		let split = body.split('\n');

		if (!split || split.length < 4) return callback();

		let html = split[3].slice(6);
		html = html.substr(0, html.length - 5);

		let $ = cheerio.load(html);

		// add target bank to link youtube
		$('a[href*="youtube.com"]').each(function () {
			$(this).attr('target', '_blank');
		});

		// hide time of table


		let $style = cheerio.html($('style'));
		let $body = $('body').html();

		let final = `${$style}${$body}`;
		let data = _parseDataMatchOfLeague($body);

		let result = {
			rawHtml: final,
			data
		}

		return callback(err, result);
	})
}

const standingOfLeague = (opt, callback) => {
	opt = Object.assign({}, default_Option, opt);

	let slug = opt.slug;

	if (!FOOTBALL_LEAGUE[slug]) return callback(null, null);

	let emid = FOOTBALL_LEAGUE[slug].emid;
	let lmid = FOOTBALL_LEAGUE[slug].lmid;

	let date = moment().add(-2, 'd').utcOffset(0).format('YYYY-MM-DDTHH:00:00') + 'Z';

	// let urlGet = `https://www.google.com/async/lr_lg_fp?async=sp:2,ct:${opt.ct},hl:${opt.hl},tab:st,tz:${opt.tz},emid:${emid},_id:liveresults-sports-immersive__updatable-league-matches,_fmt:pc`;

	let urlGet = `https://www.google.com/async/lr_sma_tb?async=ct:${opt.ct},hl:${opt.hl},tz:${opt.tz},dtoint:${date},dtointmid:${emid},emid:${emid},et:lg,gndr:UNKNOWN_GENDER,lmid:/m/02_tc,rtab:3,sp:2,_fmt:prog,_id:tab-1-3,_jsfs:Ffpdje`;

	console.log('standingOfLeague url=', urlGet);

	request({
		url: urlGet,
		method: 'GET'
	}, (err, response, body) => {
		if (err) return callback(err);

		if (!body || body.length == 0) return callback();

		let split = body.split('\n');

		if (!split || split.length < 4) return callback();

		let html = split[3].slice(6);
		html = html.substr(0, html.length - 5);

		let result = {
			rawHtml: html
		}

		return callback(err, result);
	})
}

const newsOfLeague = (opt, callback) => {
	opt = Object.assign({}, default_Option, opt);

	let slug = opt.slug;

	if (!FOOTBALL_LEAGUE[slug]) return callback(null, null);

	let emid = FOOTBALL_LEAGUE[slug].emid;
	let lmid = FOOTBALL_LEAGUE[slug].lmid;
	let title_vn = FOOTBALL_LEAGUE[slug].title_vn;

	// let urlGet = `https://www.google.com/async/lr_lg_fp?async=sp:2,ct:${opt.ct},hl:${opt.hl},tab:nw,tz:${opt.tz},emid:${emid},_id:liveresults-sports-immersive__updatable-league-matches,_fmt:pc`;

	let urlGet = `https://www.google.com/search?yv=3&q=&asearch=lr_nt&async=emids:${lmid},en:${title_vn},et:lg,lmid:${lmid},mmid:,sp:2,_fmt:prog,_id:news-tab--347155782,_jsfs:Ffpdje`;
	urlGet = encodeURI(urlGet);

	console.log('newsOfLeague url=', urlGet);

	request({
		url: urlGet,
		method: 'GET',
		jar: cookie
	}, (err, response, body) => {
		if (err) return callback(err);

		if (!body || body.length == 0) return callback();
		// return callback(err, body);
		let split = body.split('\n');

		if (!split || split.length < 5) return callback();

		let html = split[3].slice(5);
		html = html + split[4];

		html = html.substr(0, html.length - 5);

		let result = {
			rawHtml: html
		}

		return callback(err, result);
	})
}

const statOfLeague = (opt, callback) => {
	opt = Object.assign({}, default_Option, opt);

	let slug = opt.slug;

	if (!FOOTBALL_LEAGUE[slug]) return callback(null, null);

	let emid = FOOTBALL_LEAGUE[slug].emid;
	let lmid = FOOTBALL_LEAGUE[slug].lmid;

	let date = moment().add(-2, 'd').utcOffset(0).format('YYYY-MM-DDTHH:00:00') + 'Z';

	// vet=12ahUKEwjQvdeM0ILnAhWFfn0KHVc-CHQQo-sBegQIARAW..i&ei=b3UdXpP5G9u6rQHi06TYAQ&yv=3&q=&

	// lr_sma_tb ct:VN,hl:vi,tz:Asia/Saigon,dtoint:2020-01-12T14:00:00Z,dtointmid:/g/11fj6snmjm,emid:/g/11fj6snmjm,et:lg,gndr:UNKNOWN_GENDER,lmid:/m/02_tc,rtab:3,sp:2,_fmt:prog,_id:tab-1-3,_jsfs:Ffpdje

	let urlGet = `https://www.google.com/async/lr_sma_tb?async=ct:${opt.ct},hl:${opt.hl},tz:${opt.tz},dtoint:${date},dtointmid:${emid},emid:${emid},et:lg,gndr:UNKNOWN_GENDER,lmid:/m/02_tc,rtab:19,sp:2,_fmt:prog,_id:tab-1-19,_jsfs:Ffpdje`;

	console.log('statOfLeague url=', urlGet);

	request({
		url: urlGet,
		method: 'GET'
	}, (err, response, body) => {
		if (err) return callback(err);

		if (!body || body.length == 0) return callback();

		let split = body.split('\n');

		if (!split || split.length < 4) return callback();

		let html = split[3].slice(5);
		html = html.substr(0, html.length - 5);

		let result = {
			rawHtml: html
		}

		return callback(err, result);
	})
}

const playerOfLeague = (opt, callback) => {
	opt = Object.assign({}, default_Option, opt);

	let slug = opt.slug;

	if (!FOOTBALL_LEAGUE[slug]) return callback(null, null);

	let emid = FOOTBALL_LEAGUE[slug].emid;
	let lmid = FOOTBALL_LEAGUE[slug].lmid;

	let date = moment().add(-2, 'd').utcOffset(0).format('YYYY-MM-DDTHH:00:00') + 'Z';

	// ct:VN,hl:vi,tz:Asia/Saigon,dtoint:2020-01-12T14:00:00Z,dtointmid:/g/11fj6snmjm,emid:/g/11fj6snmjm,et:lg,gndr:MALE,lmid:/m/02_tc,rtab:20,sp:2,_fmt:prog,_id:tab-1-20,_jsfs:Ffpdje
	let urlGet = `https://www.google.com/async/lr_sma_tb?async=ct:${opt.ct},hl:${opt.hl},tz:${opt.tz},dtoint:${date},dtointmid:${emid},emid:${emid},et:lg,gndr:UNKNOWN_GENDER,lmid:${lmid},rtab:20,sp:2,_fmt:prog,_id:tab-1-20,_jsfs:Ffpdje`;

	console.log('playerOfLeague url=', urlGet);

	request({
		url: urlGet,
		method: 'GET'
	}, (err, response, body) => {
		if (err) return callback(err);
		if (!body || body.length == 0) return callback();

		let split = body.split('\n');

		if (!split || split.length < 4) return callback();

		let html = split[3].slice(5);
		html = html.substr(0, html.length - 5);

		let $ = cheerio.load(html);
		let lastId = null;
		let count = 0;

		for (let i = 11; i < split.length; i++) {
			count++;
			let text = split[i];
			let dataBase64 = null;

			let start = text.indexOf(';') + 1;
			let end = text.lastIndexOf(';') + 1;

			dataBase64 = text.substr(start, end - start);
			if (dataBase64 && dataBase64.length < 20) {
				end = text.lastIndexOf('[');

				if (end > -1) {
					dataBase64 = text.substr(start, end - start);
				} else {
					dataBase64 = text.substr(start);
				}
			}

			let lastEqual = dataBase64.lastIndexOf('=');
			let lastSlash = dataBase64.lastIndexOf('/');

			if (lastEqual > -1) {
				dataBase64 = dataBase64.substr(0, lastEqual + 1);
			} else {
				if (lastSlash > 15) {
					dataBase64 = dataBase64.substr(0, lastSlash + 1);
				}
			}

			if (dataBase64 && dataBase64.length > 0) {
				$(`#${lastId}`).attr('src', dataBase64);
				// console.log(`i= ${i} :: count= ${count} :: #${lastId} - ${dataBase64} \n`);
			}

			let array = text.substr(text.lastIndexOf(';') + 1);
			array = safeParse(array);
			if (array && array.length > 1) {
				lastId = array[1];
			}
		}

		let $style = cheerio.html($('style'));
		let $body = $('body').html();

		let final = `${$style}${$body}`;

		let result = {
			rawHtml: final
		}

		return callback(err, result);
	})
}

const statOfPlayer = (opt, callback) => {
	if (!opt || !opt.name) return callback('ENONAME');

	let urlStatPlayer = `https://www.google.com/search?q=${opt.name} stats&expnd=1&sa=X&biw=1800&bih=365`;

	request({
		url: urlStatPlayer,
		method: 'GET',
		headers: {
			// use desktop
			'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36'
		},
		jar: cookie
	}, (err, response, body) => {
		if (err) return callback(err);

		let $ = cheerio.load(body);

		let playerStat = $('[data-attrid="kc:/sports/pro_athlete:stats"]');
		$('ol li label', playerStat).remove();

		let rawHtmlStat = playerStat.html();

		let result = {
			rawHtmlStat,
			data: {}
		}

		return callback(null, result);
	})
}

const timelineOfMatch = (opt, callback) => {
	opt = Object.assign({}, default_Option, opt);

	let slugLeague = opt.slugLeague;
	let matchMid = opt.matchMid;

	if (!matchMid) return callback('EMISSMATCHMID');
	if (!FOOTBALL_LEAGUE[slugLeague]) return callback('ELEAGUENOTFOUND');

	let emid = FOOTBALL_LEAGUE[slugLeague].emid;
	let lmid = FOOTBALL_LEAGUE[slugLeague].lmid;

	let urlGet = `https://www.google.com/async/lr_sma_tb?yv=3&q=&async=ct:${opt.ct},hl:${opt.hl},tz:${opt.tz},dtoint:,dtointmid:,emid:${matchMid},et:mt,gndr:UNKNOWN_GENDER,lmid:${lmid},rtab:7,sp:2,_fmt:prog,_id:tab-3-7,_jsfs:Ffpdje`;

	console.log(`timelineOfMatch urlGet= ${urlGet}`);

	request({
		url: urlGet,
		method: 'GET',
		jar: cookie
	}, (err, response, body) => {
		if (err) return callback(err);

		if (!body || body.length == 0) return callback();

		let split = body.split('\n');

		if (!split || split.length < 4) return callback();

		let html = split[3].slice(5);
		html = html.substr(0, html.length - 5);

		let result = {
			rawHtml: html
		}

		return callback(null, result);
	})
}

const lineupsOfMatch = (opt, callback) => {
	opt = Object.assign({}, default_Option, opt);

	let slugLeague = opt.slugLeague;
	let matchMid = opt.matchMid;

	if (!matchMid) return callback('EMISSMATCHMID');
	if (!FOOTBALL_LEAGUE[slugLeague]) return callback('ELEAGUENOTFOUND');

	let emid = FOOTBALL_LEAGUE[slugLeague].emid;
	let lmid = FOOTBALL_LEAGUE[slugLeague].lmid;

	let urlGet = `https://www.google.com/async/lr_sma_tb?yv=3&q=&async=ct:${opt.ct},hl:${opt.hl},tz:${opt.tz},dtoint:,dtointmid:,emid:${matchMid},et:mt,gndr:UNKNOWN_GENDER,lmid:${lmid},rtab:6,sp:2,_fmt:prog,_id:tab-3-6,_jsfs:Ffpdje`;

	console.log(`lineupsOfMatch urlGet= ${urlGet}`);

	request({
		url: urlGet,
		method: 'GET',
		jar: cookie
	}, (err, response, body) => {
		if (err) return callback(err);

		if (!body || body.length == 0) return callback();

		let split = body.split('\n');

		if (!split || split.length < 4) return callback();

		let html = split[3].slice(5);
		html = html.substr(0, html.length - 5);

		let result = {
			rawHtml: html
		}

		return callback(null, result);
	})
}

const statsOfMatch = (opt, callback) => {
	opt = Object.assign({}, default_Option, opt);

	let slugLeague = opt.slugLeague;
	let matchMid = opt.matchMid;

	if (!matchMid) return callback('EMISSMATCHMID');
	if (!FOOTBALL_LEAGUE[slugLeague]) return callback('ELEAGUENOTFOUND');

	let emid = FOOTBALL_LEAGUE[slugLeague].emid;
	let lmid = FOOTBALL_LEAGUE[slugLeague].lmid;

	let urlGet = `https://www.google.com/async/lr_sma_tb?yv=3&q=&async=ct:${opt.ct},hl:${opt.hl},tz:${opt.tz},dtoint:,dtointmid:,emid:${matchMid},et:mt,gndr:UNKNOWN_GENDER,lmid:${lmid},rtab:10,sp:2,_fmt:prog,_id:tab-3-10,_jsfs:Ffpdje`;

	console.log(`statsOfMatch urlGet= ${urlGet}`);

	request({
		url: urlGet,
		method: 'GET',
		jar: cookie
	}, (err, response, body) => {
		if (err) return callback(err);

		if (!body || body.length == 0) return callback();

		let split = body.split('\n');

		if (!split || split.length < 4) return callback();

		let html = split[3].slice(6);
		html = html.substr(0, html.length - 5);

		let result = {
			rawHtml: html
		}

		return callback(null, result);
	})
}

const newsOfMatch = (opt, callback) => {
	opt = Object.assign({}, default_Option, opt);

	let slugLeague = opt.slugLeague;
	let matchMid = opt.matchMid;

	let hostName = opt.hostName;
	let clientName = opt.clientName;

	if (!matchMid) return callback('EMISSMATCHMID');
	if (!FOOTBALL_LEAGUE[slugLeague]) return callback('ELEAGUENOTFOUND');

	let emid = FOOTBALL_LEAGUE[slugLeague].emid;
	let lmid = FOOTBALL_LEAGUE[slugLeague].lmid;

	let urlGet = `https://www.google.com/search?yv=3&q=&asearch=lr_nt&async=emids:/m/0hvjr;/m/04ltf,en:${hostName};${clientName},et:mt,lmid:${lmid},mmid:${matchMid},sp:2,_fmt:prog,_id:news-tab-1826535093,_jsfs:Ffpdje`;

	console.log(`newsOfMatch urlGet= ${urlGet}`);

	request({
		url: urlGet,
		method: 'GET',
		jar: cookie
	}, (err, response, body) => {
		if (err) return callback(err);

		if (!body || body.length == 0) return callback();

		let split = body.split('\n');

		if (!split || split.length < 4) return callback();

		let html = split[3].slice(4);
		html = html.substr(0, html.length - 5);

		let result = {
			rawHtml: html
		}

		return callback(null, result);
	})
}

const layoutHeaderOfMatch = (opt, callback) => {
	opt = Object.assign({}, default_Option, opt);

	let slugLeague = opt.slugLeague;
	let matchMid = opt.matchMid;

	if (!matchMid) return callback('EMISSMATCHMID');
	if (!FOOTBALL_LEAGUE[slugLeague]) return callback('ELEAGUENOTFOUND');

	let emid = FOOTBALL_LEAGUE[slugLeague].emid;
	let lmid = FOOTBALL_LEAGUE[slugLeague].lmid;

	let urlGet = `https://www.google.com/async/lr_mt_fp?yv=3&async=sp:2,lmid:${lmid},tab:tl,emid:${matchMid},rbpt:undefined,ct:${opt.ct},hl:${opt.hl},tz:${opt.tz},_id:liveresults-sports-immersive__match-fullpage,_pms:s,_jsfs:Ffpdje,_fmt:pc`;

	console.log(`layoutHeaderOfMatch urlGet= ${urlGet}`);

	request({
		url: urlGet,
		method: 'GET',
		jar: cookie
	}, (err, response, body) => {
		if (err) return callback(err);

		if (!body || body.length == 0) return callback();

		let split = body.split('\n');

		if (!split || split.length < 4) return callback();

		let html = split[3].slice(6);
		html = html.substr(0, html.length - 5);

		let $ = cheerio.load(html);

		$('svg').remove();
		$('[jsaction="jsa.back"]').remove();
		$('.lr-imso-fix .imso-eib').remove();
		$('.tb_u').remove();
		$('.imspo_mff__mff-tnss').remove();

		let $style = cheerio.html($('style'));
		let $body = $('body').html();

		let final = `${$style}${$body}`;

		let result = {
			rawHtml: final
		}

		return callback(null, result);
	})
}

const newsOfClub = () => {

}

const playerOfClub = () => {

}

const matchOfClub = () => {

}

module.exports = {
	matchOfLeague,
	standingOfLeague,
	newsOfLeague,
	statOfLeague,
	playerOfLeague,
	statOfPlayer,
	timelineOfMatch,
	lineupsOfMatch,
	statsOfMatch,
	newsOfMatch,
	layoutHeaderOfMatch,
}
